## 数学运算

### ee数据图层间运算

- 根据landsat数据计算NDVI

```python
import ee

landsat1999 = ee.Image('LANDSAT/LE7_TOA_5YEAR/1999_2003')

ndvi1999 = landsat1999.select('B4').subtract(landsat1999.select('B3'))\
  			.divide(landsat1999.select('B4').add(landsat1999.select('B3')))
```



#### Expressions方法

- **expression()** 的运输符

|                | expression()符号 | 普通方法                                           |
| -------------- | ---------------- | -------------------------------------------------- |
| **算术运算符** | + - * / % **     | add, subtract, multiply, divide, modulus, exponent |
| **比较运算符** | == != < > <= >=  | equal, not equal, less than, greater than, etc.    |
| **逻辑运算符** | && \|\| ! ^      | And, Or, Not, Xor                                  |
| **条件运算符** | ? :              | If then else                                       |

- 算术运算

```python
import ee
import geemap

Map = geemap.Map()

image = ee.Image('LANDSAT/LC08/C01/T1_TOA/LC08_044034_20140318')

evi = image.expression(
    '2.5 * ((NIR - RED) / (NIR + 6 * RED - 7.5 * BLUE + 1))', {
      'NIR': image.select('B5'),
      'RED': image.select('B4'),
      'BLUE': image.select('B2')
})

Map.centerObject(image, 8)
Map.addLayer(evi, {'min': -1, 'max': 1, 'palette': ['FF0000', '00FF00']})
Map
```

![image-20201125152223637](https://img2020.cnblogs.com/blog/2213660/202011/2213660-20201125152225224-613796152.png)



- 逻辑运算

  - 

  ```python
  image = ee.Image('LANDSAT/LC08/C01/T1_TOA/LC08_044034_20140318')
  
  ndvi = image.normalizedDifference(['B5', 'B4'])
  ndwi = image.normalizedDifference(['B3', 'B5'])
  # 普通方法
  bare = ndvi.lt(0.2).And(ndwi.lt(0))
  
  Map.setCenter(-122.3578, 37.7726, 11)
  Map.addLayer(bare.updateMask(bare), {}, 'bare')
  # expression方法
  bare2 = ndvi.expression(
      'IT1 && IT2',{
          'IT1': ndvi.lt(0.2),
          'IT2': ndwi.lt(0)
      }
  )
  Map.addLayer(bare.updateMask(bare2), {}, 'bare2')
  ```

  ![image-20201125160314284](https://img2020.cnblogs.com/blog/2213660/202011/2213660-20201125160315097-186473275.png)

- 

